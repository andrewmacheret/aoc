import sys

sys.setrecursionlimit(100000)

class Cart:
  static_index = 1
  def __init__(self, track, intersection, direction, progress, coming_from_intersection_index, location):
    self.track = track
    self.intersection = intersection # if present, progress should be 0
    self.direction = direction
    self.progress = progress
    self.coming_from_intersection_index = coming_from_intersection_index
    self.name = 'C' + str(Cart.static_index)
    self.turn_index = 1
    self.location = location
    Cart.static_index += 1
  
  def is_on_track(self):
    return self.intersection is None
  
  def progress_one_step(self):
    if self.progress < self.track.length:
      # progress
      self.progress += 1
      self.intersection = None
      track_path_index = self.progress - 1 if self.coming_from_intersection_index == 0 else (self.track.length - self.progress)
      self.location = self.track.path[track_path_index]
    else:
      # enter the intersection and turn
      intersection_index = (self.coming_from_intersection_index + 1) % 2
      self.intersection = self.track.intersections[intersection_index]['intersection']
      dx, dy = self.track.intersections[intersection_index]['dir']
      self.direction = (-dx, -dy)
      self.turn()
      self.progress = 0
      self.location = self.intersection.location

      # set up next track
      dx, dy = self.direction
      if len(self.intersection.tracks) < 4:
        print('BAD')
        print(str(self))
        print(str(self.intersection))
      self.track = self.intersection.tracks[(dx, dy)]
      self.coming_from_intersection_index = 0 if self.track.intersections[0]['intersection'] == self.intersection else 1

      #print('new track is', self.track.path)
      #print('new intersection is', self.intersection.name, self.track.intersections[self.coming_from_intersection_index]['intersection'].name)
  
  def turn(self):
    # -1 is turn left
    # 0 is go straight
    # 1 is turn right
    self.direction = DIRS[(DIRS.index(self.direction) - self.turn_index + len(DIRS)) % 4]
    self.turn_index = self.turn_index % 3 - 1

  def __str__(self):
    return str({
      'name': self.name,
      'track': self.track.name,
      'intersection': self.intersection.name if self.intersection else None,
      'progress': self.progress,
      'direction': self.direction,
      'location': self.location
    })

class Track:
  static_index = 1
  def __init__(self, firstIntersection, firstDir):
    self.intersections = [{
      'intersection': firstIntersection,
      'dir': firstDir
    }]
    self.path = []
    self.name = 'T' + str(Track.static_index)
    Track.static_index += 1
  def __str__(self):
    return str({
      'name': self.name,
      'length': self.length,
      'intersections': sorted((obj['dir'], obj['intersection'].name) for obj in self.intersections),
      'path': self.path
    })

class Intersection:
  static_index = 1
  def __init__(self, location):
    self.tracks = {}
    self.location = location
    self.name = 'I' + str(Intersection.static_index)
    Intersection.static_index += 1
  def __str__(self):
    return str({
      'name': self.name,
      'tracks': sorted((dir, track.name) for dir, track in self.tracks.iteritems()),
      'location': self.location
    })

CART_TYPES = '^<>v'
VERT_TYPES = CART_TYPES + '\\|/+'
HORIZ_TYPES = CART_TYPES + '\\-/+'
DIR_BY_CART_TYPE = {
  '^': (0, -1),
  'v': (0, +1),
  '<': (-1, 0),
  '>': (+1, 0)
}

DIRS = [
  (1, 0),
  (0, 1),
  (-1, 0),
  (0, -1)
]

def find_first_crash(map):
  grid = [[c for c in line] for line in map.split('\n')]
  
  tracks = {} # (location1, location2) -> track
  carts = {} # location -> track
  intersections = {} # location -> intersection

  n = len(grid)
  m = len(grid[0])
  #print(n, m)

  print '    ' + ''.join(str(i%10) for i in range(m))
  for i, row in enumerate(grid):
    print(str(i % 10) + ' > ' + ''.join(row) + ' <')

  def dfs(track, firstI, x, y, fromX, fromY, origX, origY, origDx, origDy, length=1):
    if not (0 <= x < m and 0 <= y < n): return
    #print(track, firstI, x, y, fromX, fromY, origX, origY, origDx, origDy, length)

    ch = grid[y][x]
    grid[y][x] = ' '

    #print(ch, x, y, fromX, fromY, origX, origY, origDx, origDy, length)

    dx = x - fromX
    dy = y - fromY

    if ch in CART_TYPES:
      progress_dir = -1 if (ch == '^' and dy == 1) or (ch == 'v' and dy == -1) or (ch == '<' and dx == 1) or (ch == '>' and dx == -1) else 1
      progress = progress_dir * length
      cart_dx, cart_dy = track.intersections[0]['dir']
      carts[(x, y)] = Cart(track, None, (-cart_dx, -cart_dy), progress, 1 if progress_dir == -1 else 0, (x, y))
      #print(carts[(x, y)].name, track.name, (-cart_dx, -cart_dy), progress, 1 if progress_dir == -1 else 0, (x, y))

    elif ch == '/':
      dx, dy = -dy, -dx
    
    elif ch == '\\':
      dx, dy = dy, dx

    elif ch == '+' or ch == ' ':
      # we reached the end, no more track!
      if (x, y) not in intersections:
        newI = intersections[(x, y)] = Intersection((x, y))
      else:
        newI = intersections[(x, y)]

      if track:
        track.intersections.append({
          'intersection': newI,
          'dir': (-dx, -dy)
        })
        track.length = length - 1
        newI.tracks[(-dx, -dy)] = track
        firstI.tracks[(origDx, origDy)] = track
        track_key = tuple([(origX, origY), (x, y), (origDx, origDy)])
        tracks[track_key] = track
        #print('added track', track.name, track_key)

      #print('go!')
      for dx, dy in DIRS:
        if 0 <= x+dx < m and 0 <= y+dy < n and grid[y+dy][x+dx] != ' ':
          new_track = Track(newI, (dx, dy))
          #print('going ', dx, dy, new_track.name)
          dfs(new_track, newI, x+dx, y+dy, x, y, x, y, dx, dy)
      #print('done!')
      return

    track.path.append((x, y))
    dfs(track, firstI, x + dx, y + dy, x, y, origX, origY, origDx, origDy, length+1)

  for y in xrange(n):
    for x in xrange(m):
      if grid[y][x] == '+':
        print('begin', x, y)
        dfs(None, None, x, y, x, y, x, y, 0, 0)
        print('---')
        #for row in grid:
        #  print(''.join(row))

  carts_on_tracks = {}
  carts_on_intersections = {}
  crash = False

  for location, cart in carts.iteritems():
    if cart.progress < 0:
      cart.progress += cart.track.length + 1
    else:
      dx, dy = cart.track.intersections[1]['dir']
      cart.direction = (-dx, -dy)
    if cart.is_on_track():
      track_name = cart.track.name
      if track_name not in carts_on_tracks:
        carts_on_tracks[track_name] = {}
      if cart.direction not in carts_on_tracks[track_name]:
        carts_on_tracks[track_name][cart.direction] = []
      carts_on_tracks[track_name][cart.direction].append(cart.name)
      if len(carts_on_tracks[track_name]) > 1:
        crash = True
    else:
      intersection_name = cart.intersection.name
      if intersection_name not in carts_on_intersections:
        carts_on_intersections[intersection_name] = [cart_name]
      else:
        carts_on_intersections[intersection_name].append(cart_name)
        crash = True

  #print('---')
  #print('\nTracks:')
  #for location, track in tracks.iteritems():
  #  print(location, str(track))

  #print('\nIntersections:')
  #for location, intersection in intersections.iteritems():
  #  print(location, str(intersection))

  #print('\nCarts:')
  #for location, cart in carts.iteritems():
  #  print(location, str(cart))

  all_carts = [cart for cart in carts.itervalues()]
  def tick():
    crashed = False
    for cart in all_carts:
      old_location = cart.location
      cart.progress_one_step()
      new_location = cart.location
      del carts[old_location]
      if new_location in carts:
        crashed = True
      else:
        carts[new_location] = cart
    return crashed

  round = 1
  while True:
    if tick():
      break
    round += 1

  
  #print('\nCarts:')
  #for cart in carts.itervalues():
  #  print(str(cart))

  return round







map = """\
/->-\\      
|   |/----\\
| /-++-\\  |
| | || v  |
\\-+-/\\-+--/
  \\----/   """
print(find_first_crash(map))

map = """\
            /-------------------------------------------------------------------------------------\\               /-------------------------------\\   
  /---------+---\\                                                                   /-------------+---------------+---\\              /-----------\\|   
  |       /-+---+-----------------------------------------------\\                 /-+-------------+---------------+---+----\\         |           ||   
  |       | |   |                /----------\\      /------------+------------\\    | |/------------+---------------+---+----+---------+------\\    ||   
 /+-------+-+---+----------------+----------+--\\   |  /---------+------------+----+-++------------+---------------+---+----+---------+--\\   |    ||   
 ||       | |   |                |          |  |   |  |         |           /+----+-++------------+---------------+---+----+---------+--+---+\\   ||   
 ||       | |   | /--------------+----------+--+---+--+---------+-----------++----+\\||            |         /-----+---+----+---\\     |  |   ||   ||   
 ||       | |/--+-+------\\       |          |  | /-+--+---------+-----------++----++++------------+---------+-----+---+----+---+-----+--+---++---++\\  
 ||       | ||  | |      |       |   /------+--+-+-+--+---------+-----------++----++++------------+------\\  |     |   |    |   |     |  |   ||   |||  
 ||       | ||  | |      |       |/--+-----\\|  | | |  |         |           ||    ||||            |      |  |     |   |    |   |     |  |   ||   |||  
 ||       | ||  | |      |       ||  |     ||  | | |  |         |           ||    ||||            |      |  |     |   | /--+---+-----+--+---++---+++\\ 
 ||       | ||  | |      |       ||  |     ||  | |/+--+---------+-----------++----++++------------+------+--+-----+---+-+--+---+-----+--+---++-\\ |||| 
 ||   /---+-++--+-+------+-------++--+-----++--+-+++--+---------+---\\       ||    ||||            |      |  |     |   | |  |   |     \\--+---++-+-/||| 
 ||   |   \\-++--+-+------+-------++--+-----++--+-+++--+---------/   |       ||    ||||            |      |  |     |   | |  |   |        |   || |  ||| 
 ||  /+-----++--+-+------+-------++--+-----++--+-+++--+-------------+-------++----++++-----------\\|      |  |     |   | |  |   |        |   || |  ||| 
 ||  ||     ||  | |      |   /---++--+-----++--+-+++--+-------------+-------++----++++-----------++-----\\|  |     |   | |  | /-+-------\\|   || |  ||| 
 ||  ||     ||  | |   /--+---+---++--+-----++--+-+++--+-------------+-------++----++++-----------++-----++--+-----+\\  | |  | | |       ||   || |  ||| 
 ||  || /---++--+-+---+--+---+---++--+-----++--+-+++--+-------------+-------++--\\ ||||           ||     ||  |     ||  | |  | | |       ||   || |  ||| 
 ||  || |/--++--+-+---+--+---+---++--+-----++--+-+++-\\|    /--------+-------++--+-++++-----------++->---++--+-----++--+-+--+-+-+---\\   ||   || |  ||| 
 ||  || ||  ||  | |   |  |   |   \\+--+-----+/  | ||| ||    |        |       ||  | ||||       /---++-----++--+-----++--+-+--+-+\\|   |   ||   || |  ||| 
 \\+--++-++--++--+-+---+--+---+----+--+-----+---/ ||| ||    |        |       ||/-+-++++-------+---++-----++--+-----++--+-+--+-+++---+-\\ ||   || |  ||| 
  | /++-++--++--+-+---+--+---+----+--+-----+-----+++-++----+-------\\|       ||| | ||||       |   ||     ||  |     ||  | |  | |||   | | ||   || |  ||| 
/-+-+++-++--++--+-+---+--+---+----+--+-----+-----+++-++----+-------++-------+++-+-++++------\\|   ||     ||  |     ||  | \\--+-+++---+-+-++---++-+--++/ 
| | ||| ||  |\\--+-+---+--/   |  /-+--+---\\ |     ||| ||    |       ||      /+++-+-++++------++---++-----++--+-----++--+---\\| |||   | | ||   || |  ||  
| | ||| ||  |   | |   |     /+--+-+--+---+-+-----+++-++----+--\\  /-++------++++-+-++++------++---++-----++--+-----++--+---++-+++---+>+-++--\\|| |  ||  
| | ||| || /+---+-+---+-----++--+-+--+---+-+-----+++-++----+--+--+-++---->-++++-+-++++---\\  ||   ||     ||  |     ||  |   || |||   | | ||  ||| |  ||  
| | ||| || ||   | |   |     ||  | |  |   | |   /-+++-++----+--+--+-++------++++-+-++++---+--++---++-----++--+-----++--+---++-+++\\  | | ||  ||| |  ||  
| | ||| || ||   | |   |     ||  | |  |   | |   | ||| ||    |  |  | ||      |||| | ||||   |  ||   ||     ||  |     ||  |   || ||||  | | ||  ||| |  ||  
|/+-+++-++-++---+-+---+-----++--+-+--+---+-+---+-+++-++----+--+--+-++-\\    |||| | ||||   |  ||   ||     ||  |     ||  |   || ||||  | | ||  ||| |  ||  
||| ||| || ||   |/+---+-----++--+-+--+---+-+---+-+++-++----+--+--+-++-+----++++-+-++++---+--++---++-----++--+-----++--+-\\ || ||||  | | ||  ||| |  ||  
||| ||| || || /-+++---+-----++--+-+-\\|   | |  /+-+++-++----+--+--+-++-+----++++-+-++++---+--++---++-----++--+-----++--+\\| || ||||  | | ||  ||| |  ||  
||| ||| || || | |||   \\-----++--+-+-++---+-+--++-+++-++----+--+--+-++-+----++++-+-++++---+--++---++-----++--+-----+/  ||| || ||||  | | ||  ||| |  ||  
||| ||| || || | |||         ||  | \\-++---+-/  || ||\\-++----+--+--+-++-+----++/| | |||| /-+--++---++-----++--+-----+---+++-++-++++--+-+-++--+++-+--++-\\
||| ||| || || | |||         ||  |/--++---+----++-++--++----+--+--+-++-+----++-+-+\\|||| | |  ||   ||     ||  |     |   ||| || ||||  | | ||  ||| |  || |
||| ||| ||/++-+-+++---------++-\\||  ||   |    || ||/-++----+--+--+-++-+----++-+-++++++-+-+--++---++-----++--+-----+---+++-++-++++--+-+-++--+++\\|  || |
||| ||| ||||| | |||         || |||  ||   |    || ||| ||    |  |  | || |    \\+-+-++++++-+-+--++---++-----++--+-----+---+++-/| ||||  | | ||  |||||  || |
||| ||| ||||| | |||       /-++-+++--++---+----++-+++-++----+--+--+-++-+-----+-+-++++++-+-+--++---++-----++--+-----+---+++--+-++++--+-+\\||  |||||  || |
||| ||| ||||| | |||       | || |||  ||/--+----++-+++-++----+--+--+-++-+-----+-+-++++++-+-+--++---++-----++--+-----+---+++--+-++++--+-++++\\ |||||  || |
||| ||| ||||| | |||       | || |||  |||  |    |\\-+++-++----+--+--+-++-+-----+-+-++++++-+-+--++---++-----++--+-----+---+++--+-+++/  | ||||| |||||  || |
||| ||| ||||| | |||       | |\\-+++--+++--+----+--+++-++----+--+--+-++-+-----+-+-++++++-+-+--++---++-----/|  |     |   |||  | |||   | ||||| |||||  || |
|||/+++-+++++-+-+++-----\\ | |  |||  ||| /+----+--+++-++----+--+--+-++-+-----+-+-++++++-+-+--++---++------+--+-\\   |   |||  | |||   | ||||| |||||  || |
||||||| ||||| | |||  /--+-+-+--+++--+++-++----+--+++-++----+--+--+-++-+-----+-+-++++++-+-+--++---++------+--+-+---+---+++--+-+++-\\ | ||||| |||||  || |
||||||| ||||| | |||  |  | | |  |||  ||| ||    |  ||| ||  /-+--+--+-++-+-----+-+-++++++-+-+--++---++------+--+-+\\  |   |||  | ||| | | ||||| |||||  || |
||||||| \\++++-+-+++--+--+-+-+--+++--+++-++----+--+++-++--+-+--+--+-++-+-----+-+-/||||| v |  ||/--++------+--+-++--+---+++--+-+++-+-+-+++++\\|||||  || |
|||||||  |||| | |||  |  | | |  |||  ||| ||    |  ||| ||  | |  |  | || |     | |  ||||| | |  |||  ||      |  | ||  |   |||  | \\++-+-+-++/||||||||  || |
|||||||  |||| | |||  |  | | |  |||  ||| ||    |  ||| ||  | |  |  | || |     | |  ||||| | |  |||  ||      |  | ||  |   |||  |  || | | || ||||||||  || |
|||||||  |||| | |||  |  | | |  |||  ||| ||    |  ||| ||  | |  |  | || |     | |/-+++++-+-+--+++--++------+--+-++--+---+++--+--++-+-+-++\\||||||||  || |
|||||||  |||| | |||  |  | | |  |||  ||| ||    |  |||/++--+-+--+--+-++-+-----+-++-+++++-+-+--+++--++------+--+-++--+---+++--+\\ || | | |||||||||||  || |
|||||||  |||| | |||/-+--+-+-+--+++--+++-++----+--++++++--+-+--+--+-++-+-----+-++-+++++-+-+--+++--++------+--+-++--+---+++--++\\|| | | ||||||||^||  || |
|||||||  |||| | |||| |  | | |  |||  ||| ||    |  ||||||  | |  |  | || |     | || ||||| | |  |||  ||      |  | ||  |   |||  ||||| | | |||||||||||  || |
|||||||  |||| | |||| |  | | |  ||| /+++-++----+--++++++--+-+--+--+-++-+-----+-++-+++++-+-+--+++--++------+--+-++--+\\  |||  ||||| | | |||||||||||  || |
|||||||  |||| | |||| |  | | |  ||| |||| ||   /+--++++++--+-+--+--+-++-+-----+-++-+++++-+-+--+++--++-----\\|  | ||  ||  ||| /+++++-+-+\\|||||||||||  || |
|||||||  |||| | |||| |  | | |  ||| |||| ||   ||  ||||||  | |  |  | || |     | || ||||| | |  ||\\--++-----++--+-++--++--+++-++++++-+-+++++++/|||||  || |
|||||||  |||| | |||| |  | | |  ||| |||| ||   ||  ||||||  | |  |  | || |     | || ||||| | |  ||   ||     ||  | ||  ||  ||| |||||| | ||||||| |||||  || |
|||||||  |||| | |||| |  | | |  ||| |||| ||   ||  ||||||  | \\--+--+-++-+-----+-++-+++++-+-+--++---++-----++--+-++--++--+++-++++++-+-/|||||| |||||  || |
|||||||/-++++-+-++++-+--+-+-+--+++-++++-++---++-\\||||||  |    |  | || |     | || ||||| | |  ||   ||     ||  | ||  ||  ||| |||||| |  |||||| |||||  || |
|||||||| |||| | |||| |  | | |  ||| ||\\+-++---++-+++++++--+----+--+-++-+-----+-++-+++++-+-+--++---++-----+/  | ||  ||  ||| |||||| |  |||||| |||||  || |
|||||||| |||| | |||| |  | | \\--+++-++-+-++---++-+++++++--+----/  | || |     | || |\\+++-+-+--++---++-----+---+-++--++--+++-+/|||| |  |||||| |||||  || |
|||||||| |||| | |||| |  | |    |||/++-+-++---++-+++++++--+-------+-++-+-----+-++-+-+++-+-+--++---++\\    |   | ||  ||  ||| | |||| |  |||||| |||||  || |
|||||||| |||| | |||| |  | |    |||||| | ||   || |||||||  | /-----+-++\\|     | || | ||| | |  ||   |||    |   | ||  ||  ||| | |||| |  ^||||| |||||  || |
|||||||| |||| | |||| |  | |    |||||| | ||   \\+-+++++++--+-+-----+-++++-----+-++-+-+++-+-+--++---+++----/   | ||  ||  ||| | |||| |  |||||| |||||  || |
|||||||| |||| | |||| |  | |  /-++++++-+-++----+-+++++++--+-+-----+-++++-----+\\|| | ||| | |  |\\---+++--------+-++--++--+++-+-++/| |  |||||| |||||  || |
|||||||| |||| | |||| |  | |  | |||||| | ||    | |||||||  | |     | ||||     |||| | ||| | |  |    |||        | ||  ^|  ||| | || | |  |||||| |||||  || |
|||||||| |||| | |||| |  | \\--+-++++++-+-++----+-+++++++--+-+-----+-++++-----++++-+-+++-+-+--+----+++--------+-++--++--+++-+-++-+-+--++/||| |||||  || |
|||||||| |||| | |||| |  |    |/++++++-+-++----+-+++++++--+-+-----+-++++-----++++-+-+++-+-+--+----+++--------+-++--++--+++-+-++-+-+--++-+++\\|||||  || |
||||||||/++++-+-++++-+--+----++++++++-+-++----+-+++++++--+-+-----+-++++-----++++-+-+++-+-+--+----+++--------+-++\\/++--+++-+-++-+-+--++-+++++++++-\\|| |
||||||||||||| | |||| |/-+----++++++++-+-++----+-+++++++--+-+-----+-++++-----++++-+-+++-+-+--+----+++--------+-++++++--+++-+-++-+-+\\ || ||||||||| ||| |
|||||||\\+++++-+-++++-++-+----++++++++-+-++----+-/||||||  | |     | ||||   /-++++-+-+++-+-+\\ |    |||        | ||||||  ||| | || | || || ||||||||| ||| |
|||||||/+++++-+-++++-++-+----++++++++-+-++----+--++++++--+-+-----+-++++--\\| |||| | ||| | || |    |||        | ||||||  ||| | || | || || ||||||||| ||| |
||||||||||||| | |||| || |    ||||||\\+-+-++----+--++++++--+-+-----+-++++--++-++++-+-+++-+-++-+----+++--------+-+++++/  ||| | || | || || ||||||||| ||| |
|||||||||||||/+-++++-++-+----++++++-+-+-++----+--++++++--+-+-----+-++++--++-++++-+-+++-+-++\\|    |||        | |||||   ||| | || | || || ||||||||| ||| |
||||||||||||||| |||| || |    |||||| | | ||    |  ||||||  | |     |/++++--++-++++-+-+++-+-++++----+++\\   /---+-+++++---+++-+-++-+\\|| || ||||||||| ||| |
||||||||||||||| |||| || |    ||||\\+-+-+-++----+--++++++--+-+-----++++++--++-++++-/ ||| | ||||    ||||   |   | |||||   ||| | || |||| || ||||||||| ||| |
||||||||||||||| |||| ||/+--<-++++-+-+-+-++----+--++++++--+-+-----++++++--++-++++--\\||| | ||||    ||||   |   | |||||   ||| | || |||| || ||||||||| ||| |
||\\++++++++++++-/||| ||||    \\+++-+-+-+-++----+--++++++--+-+-----++++++--++-+/||/-++++-+-++++----++++---+---+-+++++---+++-+-++-++++-++-+++++++++\\||| |
|| ||||||||||||  |||/++++-----+++-+-+-+-++----+--++++++--+-+-----++++++--++-+-+++-++++-+-++++----++++---+---+-+++++-\\ ||| | || |||| || ||||||||||||| |
|\\-++++++++++++--++++++++-----+++-+-+-+-++----+--++++++--+-+-----+++++/  || | ||| |||| | ||||    ||||   |   \\-+++++-+-+++-+-++-/||| || ||||||||||||| |
|/-++++++++++++--++++++++-----+++-+-+-+-++----+--++++++--+-+-----+++++---++-+-+++-++++-+-++++----++++---+----\\||||| | ||| | ||  ||| || ||||||||||||| |
|| ||||||||||||  \\+++++++-----+++-+-+-+-++----+--++++++--+-+-----+++++---++-+-+++-++++-+-++++----++++---+----++++++-+-++/ | ||  ||| || ||||||||||||| |
|| |||||||||\\++---+++++++-----+++-+-+-+-++----+--++++++--+-+-----+++++---++-+-+++-++++-+-++++----+/||   |    |||||| | ||  | ||  ||| || ||||||||||||| |
|| ||||||||| ||  /+++++++-----+++-+-+\\| ||    |  ||||||  | |     |||||   || | ||| |||| | ||||    | ||   |    ^||||| | ||  | ||  ||| || ||||||||||||| |
|| ||||||||| ||  ||||||||     ||| \\-+++-++----+--++++++--+-+-----+++++---++-+-+++-++++-+-++++----+-/|   |    |||||| | ||  | ||  ||| || ||||||||||||| |
|| ||||||||| ||  ||||||||     ||\\---+++-+/    |  ||||||  | |     |||||   || | |||/++++-+-++++----+--+---+----++++++-+-++--+-++--+++-++\\||||||||||||| |
|| ||||||||| ||  ||||||||     ||    ||| |     |  |||||\\--+-+-----+++++---++-+-++++++++-+-++++----+--+---+----++++++-+-++--+-++--+++-++++/||||||||||| |
|| ||||||||| ||  ||||||||     ||    ||| |/----+--+++++---+-+-----+++++-\\ || | |||||||| | ||||    |  |   |    |||||| | ||  | ||  ||| |||| ||||||||||| |
|| ||||||||| |v  ||||||\\+-----++----+++-++----+--+++++---+-+-----+++++-+-++-+-++++/||| |/++++----+--+---+----++++++-+-++--+-++-\\||| |||| ||||||||||| |
|| |||\\+++++-++--++++++-+-----++----+++-++----+--+++++---+-+-----+++/| | || | |||| ||| ||||||    |  |   |    |||||| | ||  | || |||| |||| ||||||||||| |
|| ||| ||||| ||  |||||| |     ||    ||| ||    |  |||||   | |     ||| | | || | |\\++-+++-++++++----+--+---+----++++++-+-++--+-++-++++-+++/ ||||||||||| |
|| ||| ||||| ||  |||||| |     ||    ||| ||    |  |||||   | |     ||| | | || | | || ||| ||||||    |  |   |    |||||| | ||  | || |||| |||  ||||||||||| |
|| ||| ||||| ||  |||||| | /---++----+++-++---\\|  |||||   | |     ||| | | || | | || ||\\>++++++----+--+---+----++++++-+-++--+-++-++++-+++--+++/||||||| |
|| ||| ||||| ||  |||||| | |   ||    ||| ||   ||  |||||   | |     ||| | | || | | || |\\-<++++++----+--+---+----++++++-+-/|  | || |||| |||  ||| ||||||| |
|| ||| ||||| ||  |||||| | |   ||    ||| ||   ||  |||||   | |     ||| | | || | | \\+-+---++++++----+--+---+----++++++-+--+--+-++-++++-+++--+++-+++/||| |
||/+++-+++++-++--++++++-+-+---++-\\  ||| ||   ||  |||\\+---+-+-----+++-+-+-++-+-+--+-+---++++++----+--+---+----++++++-+>-+--+-/| |||| |||  ||| ||| ||| |
|\\++++-+++++-++--++++++-+-+---++-+--+++-++---++--+++-+---+-+-----+++-+-+-++-+-+--+-+---++++++----+--+---+----/||||| |  |  |  | |||| |||  ||| ||| ||| |
| |||| ||||| ||  |\\++++-+-+---++-+--+++-++---++--+++-+---+-+-----+++-+-+-++-+-+--+-/   ||||||    |  |  /+-----+++++-+--+--+--+-++++-+++\\ ||| ||| ||| |
| |||| ||||| ||/-+-++++-+-+---++\\|  ||| ||   ||  ||| |   | |     ||| | | || | |  |     ||||||    |  |  ||     ||||| |  |/-+--+-++++-++++-+++-+++-+++\\|
| |||| ||||| ||| | |||| | |   ||||/-+++-++---++--+++-+---+-+----\\\\++-+-+-++-+-+--+-----++++++----+--+--++-----+++++-+--++-+--+-++++-++++-++/ ||| |||||
| |||| ||||| ||| | |||| | |   ||||| ||| ||   ||  \\++-+---+-+----+-++-+-+-++-+-+--+-----++++++----+--+--++-----+++++-+--++-+--+-++++-++++-++--+++-++/||
| |||| ||||| ||| | |||\\-+-+---+++++-+++-++---++---++-+---+-+----+-++-+-+-++-+-+--+-----++++++----+--+--++-----+++++-+--++-+--+-+++/ |||| ||  ||| || ||
| ||\\+-+++++-+++-+-+++--+-+---+++++-+++-++---++---++-+---+-+----+-+/ | | ||/+-+--+-----++++++----+--+--++-----+++++-+-\\|| |  | |||  |||| ||  ||| || ||
| || | ||||| ||| | |||  | |/--+++++-+++-++---++---++-+---+-+--\\ | |  | | |||| |  |     ||||||   /+--+--++-----+++++-+-+++-+--+-+++--++++-++--+++-++\\||
| || | ||||| ||| | |||  | ||  ||||| ||| ||   ||   || | /-+-+--+-+-+--+-+-++++-+--+-----++++++---++--+--++-----+++++-+-+++-+\\ | |||  |||| ||  ||| |||||
| || | |||||/+++-+-+++--+-++--+++++-+++-++---++---++-+-+-+-+--+-+-+--+-+-++++-+--+-----++++++---++--+--++-\\   ||||| | ^|| || |/+++--++++-++-\\||| |||||
| || | ||||||||| | |||  | ||  ||||| ||\\-++---++---++-+-+-+-+--+-+-+--+-+-++++-+--+-----++++++---++--+--++-+---+++++-+-+++-++-+++++--++++-/| |||| |||||
| || | ||||||||| \\-+++--+-++--+++++-+/  ||   ||   || | | | |  | | |  | | |||\\-+--+-----++++++---++--+--++-+---+++++-+-+++-++-+++++--++++--+-+/|| |||||
| || | \\++++++++---+++--+-++--+++++-+---++---++---++-+-+-+-+--+-+-+--+-+-/||  |  |     ||||||   ||  |  || |   ||||| | ||| || |||||  ||||  | | || |||||
| || |  ||||||||   |||  | ||  ||||| |   ||   ||   || | | | |  | | |  | |  ||  |  |     ||||||   ||  |  || |   ||||| | ||| || |||||  ||||  | | || |||||
\\-++-+--++++++++---+++--+-++--+++++-+---++---++---++-+-+-+-+--+-+-+--+-+--++--+--+-----+++++/   ||  |  || |   ||||\\-+-+++-++-+++++--++++--+-+-++-+/|||
  || |  ||||||||   |||  | ||  ||||| |   ||   ||   || | | | |  | | |  | |  ||  |  |     |\\+++----++--+--++-+---++++--+-+++-++-++/|v  ||||  | | || | |||
  || |  ||||||||   |||  | ||  ||||| |   ||   ||   |\\-+-+-+-+--+-+-+--+-+--++--+--+-----+-+++----++--+--++-+---++++--+-+++-++-++-++--++++--+-+-/| | |||
  || |  ||||||||   |||  | ||  ||||| |   \\+---++---+--+-+-+-+--+-+-+--+-+--++--+--+-----+-+++----++--+--++-+---/|||  | ||| || || ||  ||||  | |  | | |||
  || |  ||||\\+++---+++--+-++--+++++-+----+---++---+--+-+-+-+--+-+-+--+-+--++--+--+-----+-+++----++--+--++-/    |||  | ||| || || ||  ||||  | |  | | |||
  || |  |||| |||   ||\\--+-++--+++++-+----+--<++---+--+-+-+-+--+-+-+--+-+--++--+--+-----+-+++----++--+--++------+++--+-+++-++-++-+/  ||||  | |  | | |||
  || |  |||\\-+++---++---+-++--+++++-+----+---++---+--+-+-+-+--+-+-+--+-+--++--+--+-----+-/||    \\+--+--++------+++--+-+++-++-++-+---++++--+-+--+-+-/||
  || |  |||  |||   ||   | ||  ||||| |    |   ||   |  | | | |  | | |  | |  ||  |  |     |  ||     |  |  ||      |||  | ||| || |\\-+---++++--+-/  | |  ||
  || |  |||  |||   ||   | ||  \\++++-+----+---++---+--+-+-+-+--+-+-+--+-+--++--+--+-----+--++-----+--+--++------+++--+-+++-++-+--+---++++--/    | |  ||
  |\\-+--+++--+++---++---/ ||   |||| |    |   ||   |  | |/+-+--+-+-+--+-+--++--+--+-----+\\ ||     |  |  ||      |||  | ||| || |  |   ||||       | |  ||
  |  |  |||  |||   ||     ||   |||| |    |   ||   \\--+-+++-+--+-+-+--+-+--++--+--+-----++-++-----+--+--++------+++--+-+++-++-+--+---++++-------/ |  ||
  |  |  |||  |||   ||     ||   |||| |    |/--++------+-+++-+--+-+-+--+>+--++--+--+-----++-++-----+--+--++------+++--+-+++-++-+--+--\\||||         |  ||
  |/-+--+++--+++---++-----++---++++-+----++--++\\     | ||| |  | | |  | |  ||  |  |     || ||     |  |  \\+------+++--+-+++-++-+--+--++++/         |  ||
  || \\--+++--+++---++-----++---++++-+----++--+++-----+-+++-+--+-+-+--+-+--++--+--+-----++-++-----/  |   |      |||  | ||| || |  |  ||||          |  ||
  ||  /-+++--+++---++-----++---++++-+----++--+++-----+-+++-+--+-+-+--+-+--++--+--+---\\ || ||        |   |      ||\\--+-+++-++-+--+--++++----------/  ||
  ||  | |||  |||   ||     ||   |||| |/---++--+++-----+-+++-+--+-+-+--+-+--++--+--+---+-++-++--------+---+------++---+-+++-++-+--+-\\||||             ||
  ||  | |\\+--+++---++-----++---++++-++---++--+++-----/ ||| |  | | |  | |  ||  |  |   | || ||        |   |      ||   | ||| || |  | |||||             ||
  ||  | | |  |||   ||     ||   |||\\-++---++--+++-------+++-+--+-/ |  | |  ||  |  \\---+-++-++--------+---+------++---+-+++-++-+--+-++++/             ||
  ||  | | |  |||   ||     \\+---+++--++---++--/||       ||\\-+--+---+--+-+--++--+------+-++-++--------+---+------/|   | ||| || |  | ||||              ||
  ||  | | |  |||   ||      |   |||  ||   ||   ||       ||  |  |   |  | |  ||  |      | \\+-++--------+---+-------+---+-+++-++-+--+-++++--------------+/
  ||  | | |  |||   ||      |   |||  ||   ||   ||       ||  |  |   |  | |  ||  |      |  | ||       /+---+-------+---+-+++\\|| |  | ||||              | 
  ||  | | |  ||\\---++------+---+/|  ||   ||   ||       ||  |  |   |  | |  ||  \\------+--+-++-------++---+-------+---+-++++++-+--+-+++/              | 
  ||  | | |  ||    ||     /+---+-+--++---++---++-------++--+--+---+--+-+--++---------+--+-++-------++---+--\\    |   | |||||| |  | |||               | 
  ||  | | |  ||    \\+-----++---+-+--++---++---++-------++--+--+---+--+-+--++---------+--+-++-------++---+--+----+---+-++++++-/  | |||               | 
  ||  | | |  ||     |     ||   | |  ||   ||   ||       |\\--+--+---+--+-+--++---------+--/ ||       ||   |  |    |   | ||||||    | |||               | 
 /++--+-+-+--++-----+-----++---+-+--++---++---++-------+--\\|  |   |  | |  ||         |    ||       ||   |  |    |   | ||||||    | |||               | 
 |||  | | |  |\\-----+-----++---+-+--/|   ||   ||       |  ||  |   |  | |  \\+---------+----/|       ||   |  |    |   | ||||||    | |||               | 
 |||  | | |  |      |     ||   | |   |   |\\---++-------+--++--+---+--+-+---+---------+-----+-------++---+--+----+---+-++++++----+-+/|               | 
 |||  | | |  |      |     ||   | |   |   |    \\+-------+--++--+---+--+-+---+---------+-----+-------++---+--+----+---+-+/||||    | | |               | 
 |\\+--+-+-+--+------+-----++---+-/   \\---+-----+-------+--++--+---+--+-+---+---------+-----+-------++---+--+----+---+-+-++++----+-/ |               | 
 | |  | | \\--+------+-----++---/         |     |       |  ||  |   \\--+-+---+---------+-----+-------+/   |  |    |   | | ||||    |   |               | 
 | |  | |    |      \\-----++-------------+-----+-------+--++--+------+-+---+---------+-----+-------+----+--+----+---/ | ||||    |   |               | 
 | |  | |    |            ||             |     |       \\--++--+------+-+---+---------+-----+-------+----+--+----+-----+-+++/    |   |               | 
 | |  | |    |            ||             |     |          |\\--+------/ |   |         |     |       |    |  |    |     | |||     |   |               | 
 | |  \\-+----+------------++-------------+-----+----------+---+--------+---+---------/     |       |    |  |    |     | |||     |   |               | 
 | |    |    \\------------++-------------+-----+----------+---+--------+---+---------------/       |    |  |    |     | \\++-----+---+---------------/ 
 | |    |                 ||             \\-----+----------+---+--------/   \\-----------------------+----+--+----+-----/  ||     |   |                 
 | |    |                 \\+-------------------+----------+---+------------------------------------+----+--/    |        ||     |   |                 
 | \\----+------------------+-------------------/          |   |                                    \\----+-------+--------/\\-----+---/                 
 |      |                  \\------------------------------+---/                                         |       |               |                     
 |      \\-------------------------------------------------+---------------------------------------------+-------/               |                     
 \\--------------------------------------------------------/                                             \\-----------------------/                     
                                                                                                                                                      """
print(find_first_crash(map))





